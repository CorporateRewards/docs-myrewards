
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>MyRewards - API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <!--<img src="images/logo.png" class="logo" alt="Logo" />-->
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="authentication">Authentication</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#token" class="toc-h2 toc-link" data-title="token">Token</a>
                  </li>
                  <li>
                    <a href="#authentication-2" class="toc-h2 toc-link" data-title="authentication">Authentication</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#core" class="toc-h1 toc-link" data-title="core">Core</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#permissions" class="toc-h2 toc-link" data-title="permissions">Permissions</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-all-permissions" class="toc-h3 toc-link" data-title="Core">Get all Permissions</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#registration-questions" class="toc-h2 toc-link" data-title="registration-questions">Registration Questions</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-all-registration-questions" class="toc-h3 toc-link" data-title="Core">Get all Registration Questions</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#registration-questions-gt-list-of-values" class="toc-h2 toc-link" data-title="registration-questions-gt-list-of-values">Registration Questions &gt; List of Values</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-list-of-values-associated-with-a-registration-question" class="toc-h3 toc-link" data-title="Core">GET List of Values associated with a registration question</a>
                          </li>
                          <li>
                            <a href="#post-create-a-new-value-on-a-list-of-values-associated-with-a-registration-question" class="toc-h3 toc-link" data-title="Core">POST Create a new value on a list of values associated with a registration question</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#site-messages" class="toc-h2 toc-link" data-title="site-messages">Site Messages</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#create-a-site-message" class="toc-h3 toc-link" data-title="Core">Create a Site Message</a>
                          </li>
                          <li>
                            <a href="#get-a-site-message" class="toc-h3 toc-link" data-title="Core">Get a Site Message</a>
                          </li>
                          <li>
                            <a href="#get-all-site-messages" class="toc-h3 toc-link" data-title="Core">Get all Site Messages</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#transactions" class="toc-h2 toc-link" data-title="transactions">Transactions</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-all-transactions" class="toc-h3 toc-link" data-title="Core">Get all Transactions</a>
                          </li>
                          <li>
                            <a href="#get-last-transaction" class="toc-h3 toc-link" data-title="Core">Get last Transaction</a>
                          </li>
                          <li>
                            <a href="#create-a-transaction" class="toc-h3 toc-link" data-title="Core">Create a Transaction</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#user-groups" class="toc-h2 toc-link" data-title="user-groups">User Groups</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-all-user-groups" class="toc-h3 toc-link" data-title="Core">Get all User Groups</a>
                          </li>
                          <li>
                            <a href="#manage-user-groups" class="toc-h3 toc-link" data-title="Core">Manage User Groups</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#user-group-gt-permissions" class="toc-h2 toc-link" data-title="user-group-gt-permissions">User Group &gt; Permissions</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-usergroup-permissions" class="toc-h3 toc-link" data-title="Core">GET UserGroup permissions</a>
                          </li>
                          <li>
                            <a href="#update-a-user-group-39-s-permission-set" class="toc-h3 toc-link" data-title="Core">Update a User Group's Permission set</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#users" class="toc-h2 toc-link" data-title="users">Users</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#create-a-user" class="toc-h3 toc-link" data-title="Core">Create a User</a>
                          </li>
                          <li>
                            <a href="#update-a-user" class="toc-h3 toc-link" data-title="Core">Update a User</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#user-gt-permissions" class="toc-h2 toc-link" data-title="user-gt-permissions">User &gt; Permissions</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-user-permissions" class="toc-h3 toc-link" data-title="Core">GET User permissions</a>
                          </li>
                          <li>
                            <a href="#post-user-permissions" class="toc-h3 toc-link" data-title="Core">POST User permissions</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#extra-features" class="toc-h1 toc-link" data-title="extra-features">Extra Features</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#data-widgets" class="toc-h2 toc-link" data-title="data-widgets">Data Widgets</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-all-data-widgets" class="toc-h3 toc-link" data-title="Extra Features">Get all Data Widgets</a>
                          </li>
                          <li>
                            <a href="#get-a-data-widget-belonging-to-a-user" class="toc-h3 toc-link" data-title="Extra Features">Get a Data Widget belonging to a User</a>
                          </li>
                          <li>
                            <a href="#update-a-data-widget-belonging-to-a-user" class="toc-h3 toc-link" data-title="Extra Features">Update a Data Widget belonging to a User</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#target-trackers" class="toc-h2 toc-link" data-title="target-trackers">Target Trackers</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-all-target-trackers" class="toc-h3 toc-link" data-title="Extra Features">Get All Target Trackers</a>
                          </li>
                          <li>
                            <a href="#get-a-target-tracker-39-s-values-belonging-to-a-user" class="toc-h3 toc-link" data-title="Extra Features">Get a Target Tracker's values belonging to a User</a>
                          </li>
                          <li>
                            <a href="#update-a-target-tracker-belonging-to-a-user" class="toc-h3 toc-link" data-title="Extra Features">Update a Target Tracker belonging to a User</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#performance-module" class="toc-h1 toc-link" data-title="performance-module">Performance Module</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#allocated-claims" class="toc-h2 toc-link" data-title="allocated-claims">Allocated Claims</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#view-allocated-claims" class="toc-h3 toc-link" data-title="Performance Module">View Allocated Claims</a>
                          </li>
                          <li>
                            <a href="#decline-allocated-claims" class="toc-h3 toc-link" data-title="Performance Module">Decline Allocated Claims</a>
                          </li>
                          <li>
                            <a href="#create-allocated-claims" class="toc-h3 toc-link" data-title="Performance Module">Create Allocated Claims</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#self-claims" class="toc-h2 toc-link" data-title="self-claims">Self Claims</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-self-claims" class="toc-h3 toc-link" data-title="Performance Module">Get Self Claims</a>
                          </li>
                          <li>
                            <a href="#decline-self-claim" class="toc-h3 toc-link" data-title="Performance Module">Decline Self Claim</a>
                          </li>
                          <li>
                            <a href="#approve-self-claim" class="toc-h3 toc-link" data-title="Performance Module">Approve Self Claim</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#data-fields" class="toc-h2 toc-link" data-title="data-fields">Data Fields</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#list-all-data-fields" class="toc-h3 toc-link" data-title="Performance Module">List all Data Fields</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#performance-categories" class="toc-h2 toc-link" data-title="performance-categories">Performance Categories</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#list-performance-categories" class="toc-h3 toc-link" data-title="Performance Module">List Performance Categories</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#performance-products" class="toc-h2 toc-link" data-title="performance-products">Performance Products</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#creating-a-product" class="toc-h3 toc-link" data-title="Performance Module">Creating a Product</a>
                          </li>
                          <li>
                            <a href="#updating-a-product" class="toc-h3 toc-link" data-title="Performance Module">Updating a Product</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#sales-data" class="toc-h2 toc-link" data-title="sales-data">Sales Data</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#create-sales-data" class="toc-h3 toc-link" data-title="Performance Module">Create Sales Data</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#recognition-module" class="toc-h1 toc-link" data-title="recognition-module">Recognition Module</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#nominations" class="toc-h2 toc-link" data-title="nominations">Nominations</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#update-a-nomination-39-s-status" class="toc-h3 toc-link" data-title="Recognition Module">Update a Nomination's status</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#reward-module" class="toc-h1 toc-link" data-title="reward-module">Reward Module</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#instant-point-vouchers-ipv" class="toc-h2 toc-link" data-title="instant-point-vouchers-ipv">Instant Point Vouchers (IPV)</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#create-an-ipv" class="toc-h3 toc-link" data-title="Reward Module">Create an IPV</a>
                          </li>
                          <li>
                            <a href="#get-an-ipv" class="toc-h3 toc-link" data-title="Reward Module">Get an IPV</a>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#points-overrides" class="toc-h2 toc-link" data-title="points-overrides">Points Overrides</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#update-a-points-override" class="toc-h3 toc-link" data-title="Reward Module">Update a points override</a>
                          </li>
                          <li>
                            <a href="#delete-a-points-override" class="toc-h3 toc-link" data-title="Reward Module">Delete a points override</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#simple-single-sign-on" class="toc-h1 toc-link" data-title="simple-single-sign-on">Simple Single Sign on</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#process-flow" class="toc-h2 toc-link" data-title="process-flow">Process flow</a>
                  </li>
                  <li>
                    <a href="#the-assertion" class="toc-h2 toc-link" data-title="the-assertion">The Assertion</a>
                  </li>
                  <li>
                    <a href="#next-steps" class="toc-h2 toc-link" data-title="next-steps">Next steps</a>
                  </li>
                  <li>
                    <a href="#further-information" class="toc-h2 toc-link" data-title="further-information">Further information</a>
                  </li>
              </ul>
          </li>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the MyRewards API documentation.</p>

<p>The first thing you will have to find out is the correct API endpoint to use for
the right environment.</p>

<ul>
<li><strong>Staging:</strong> <a href="https://staging.my-rewards.co.uk">https://staging.my-rewards.co.uk</a></li>
<li>For production access please ask your MyRewards contact</li>
</ul>

<p>A programme can have one or more API keys, each of which will be granted
permission to access different functionality from the API. As a standard, we use
RESTful json endpoints that will accept either HTML/HTTP form data or json data,
HTML/HTTP is preferred.</p>
<h1 id='authentication'>Authentication</h1><h2 id='token'>Token</h2>
<p>In order to use our API endpoints, you will need to have an API key created and
for this key to be granted the relevant permissions. To authenticate requests we
require you to pass us this key in the form of an HTTP header called
<code>Authorization</code> with the value set as <code>Token token=APIKEY</code> or <code>Token token=APIKEY:SECRETKEY</code>.</p>
<h2 id='authentication-2'>Authentication</h2>
<p>An API key now requires permissions to be assigned in order make any requests to the API. The issuer of your key will set permissions for endpoints you expect to access. If you need to access more of the API or you believe your permissions are not correct (unexpected 403 responses) then contact your key issuer.</p>

<p>Getting read access (GET) to an API endpoint does not mean that you will also have any kind of write access (PUT, PATCH, POST) and vice versa - these are separate permissions.</p>

<p>Permissions are granted on a &#39;least privilege&#39; basis in order to restrict access to the API functionality to just what is needed for a given use case i.e. user account provisioning or sales data integration etc.</p>

<aside class="warning">You must set the <strong>Authorization</strong> as detailed above</aside>
<h1 id='core'>Core</h1><h2 id='permissions'>Permissions</h2>
<p>Permissions are used to grant access to administrative and reporting areas of the programme.  They are also used to manage user access and ordering rights</p>
<h3 id='get-all-permissions'>Get all Permissions</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/permissions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable log in"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"hint"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable log in"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"resource_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"General"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Order Rewards"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"hint"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"User can order rewards if they have sufficient points available"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"resource_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Rewards module"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all permissions for the current stack</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/permissions</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>permission id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>permission name</td>
</tr>
<tr>
<td>hint</td>
<td>string</td>
<td>permission hint</td>
</tr>
<tr>
<td>resource_group_name</td>
<td>string</td>
<td>parent resource group name</td>
</tr>
</tbody></table>
<h2 id='registration-questions'>Registration Questions</h2><h3 id='get-all-registration-questions'>Get all Registration Questions</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/registration_questions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
    </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"radio"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text_1 text_2 text_3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"field_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"field_level"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"free_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>A simple endpoint will be created to fetch registration_questions for this
programme (Again scoped by API key). This is potentially optional as a list of
registration_question_ids could be provided, although this list will have to be
managed and maintained carefully. Should any new mandatory fields be added to this list,
it would require development on the client side of the API unless this list can
be dynamically consulted via the api.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/registration_questions</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>registration question identifier</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>label displayed on the form to the end user</td>
</tr>
<tr>
<td>mandatory</td>
<td>boolean</td>
<td>boolean if this question is mandatory for registration</td>
</tr>
<tr>
<td>field_type</td>
<td>string</td>
<td>options: [check_box, date_select, radio, select, text, user_group, linked_user]</td>
</tr>
<tr>
<td>options</td>
<td>string</td>
<td>options set for a choice question for check_box, select, or radio</td>
</tr>
<tr>
<td>field_name</td>
<td>string</td>
<td>the actual field name</td>
</tr>
<tr>
<td>free_text</td>
<td>boolean</td>
<td></td>
</tr>
</tbody></table>
<h2 id='registration-questions-gt-list-of-values'>Registration Questions &gt; List of Values</h2><h3 id='get-list-of-values-associated-with-a-registration-question'>GET List of Values associated with a registration question</h3>
<p>An endpoint to fetch the list of values associated with a registration question. Returns
an array of values with their name and id.</p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/registration_questions/:registration_question_id/list_of_values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=key:secret</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"List value 1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"List value 2"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/registration_questions/:registration_question_id/list_of_values</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>List value id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>List value name</td>
</tr>
</tbody></table>
<h3 id='post-create-a-new-value-on-a-list-of-values-associated-with-a-registration-question'>POST Create a new value on a list of values associated with a registration question</h3>
<p>An endpoint to create a new list value for a registration question. On completion, returns
an array of all values with their name and id.</p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/registration_questions/:registration_question_id/list_of_values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=key:secret</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Body:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My new list value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"List value 1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"List value 2"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My new list value"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>POST /api/v2/registration_questions/:registration_question_id/list_of_values</code></p>
<h5 id='body-parameters'>Body Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>the name of the new list value</td>
</tr>
</tbody></table>
<h2 id='site-messages'>Site Messages</h2>
<p>Site message are either plain text or HTML messages that appear in a User&#39;s message page. When a user 
logs in they are notified of any unread messages via a pop-up (usually in the bottom right corner)</p>
<h3 id='create-a-site-message'>Create a Site Message</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/user/{user_id}/site_messages/{id}</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=key:secret</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Body: </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello Fred. You have &lt;strong&gt;won a prize&lt;/strong&gt;. Please visit the points area for more details."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello Fred. You have &lt;strong&gt;won a prize&lt;/strong&gt;. Please visit the points area for more details."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-18T02:20:02.000+00:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint creates a new site message for a user.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>POST /api/v2/users/{user_id}/site_messages</code></p>
<h4 id='request-parameters'>Request Parameters</h4><h5 id='url-parameters'>URL Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>the ID of the user who will receive the message</td>
</tr>
</tbody></table>
<h5 id='body-parameters'>Body Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>content</td>
<td>string</td>
<td>the content of message</td>
</tr>
</tbody></table>
<h3 id='get-a-site-message'>Get a Site Message</h3>
<blockquote>
<p>Header: </p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/user/{user_id}/site_messages/{id}</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=key:secret</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello Fred. You have &lt;strong&gt;won a prize&lt;/strong&gt;. Please visit the points area for more details."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-18T02:20:02.000+00:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Retrieves a specific site message.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET /api/v2/users/{user_id}/site_messages/{id}</code></p>
<h4 id='request-parameters-2'>Request Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>The ID of the user</td>
</tr>
<tr>
<td>id</td>
<td>integer</td>
<td>The ID of the site message to retrieve</td>
</tr>
</tbody></table>
<h3 id='get-all-site-messages'>Get all Site Messages</h3>
<blockquote>
<p>Header: </p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/user/{user_id}/site_messages</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=key:secret</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="p">,</span><span class="w">
    </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello Fred. You have &lt;strong&gt;won a prize&lt;/strong&gt;. Please visit the points area for more details."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-18T02:20:02.000+00:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="p">,</span><span class="w">
    </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your Order is on it's way"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-08-16T07:58:03.000+01:00"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>Retrieves all site messages for a user.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>GET /api/v2/users/{user_id}/site_messages</code></p>
<h4 id='request-parameters-3'>Request Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>The ID of the user</td>
</tr>
</tbody></table>
<h2 id='transactions'>Transactions</h2><h3 id='get-all-transactions'>Get all Transactions</h3>
<p>This endpoint is designed to list all of a user’s transactions in json format.
The points transactions will be debits and credits with a description field.</p>

<p>All transactions listed in the response will be ordered so as to have the most
recent transaction last in the list.</p>

<p>Please remember that if a user transaction is performed on the MyRewards 2.0
platform since a request is made over the api – this balance will be out of date.</p>

<p>On the server side a check will be made that the user_id you are requesting is</p>

<ul>
<li>a valid user</li>
<li>it is a user for the programme that your api key is scoped to.</li>
</ul>

<p>That is to say that you can only retrieve transactions for users of your
MyRewards Programme.</p>

<p>The remote_transaction_id is documented in the POST endpoint for creating
transactions, this value is optional, therefore can be <code>null</code></p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/users/123/transactions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"transactions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"balance"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"transaction_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"programme points"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"remote_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"your_id_here"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"date_time"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/users/{user_id}/transactions</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><code>integer</code></td>
<td>id of this transaction</td>
</tr>
<tr>
<td>user_id</td>
<td><code>integer</code></td>
<td>user id of the user this transaction belongs</td>
</tr>
<tr>
<td>description</td>
<td><code>string</code></td>
<td>transaction description</td>
</tr>
<tr>
<td>value</td>
<td><code>integer</code></td>
<td>can be positive or negative. value of points on the transaction. Credit to the balance will be shown as a positive integer and debits will be negative</td>
</tr>
<tr>
<td>balance</td>
<td><code>integer</code></td>
<td>users running balance, at the time of the transaction</td>
</tr>
<tr>
<td>transaction_type</td>
<td><code>string</code></td>
<td>indicates the event which caused the transaction</td>
</tr>
<tr>
<td>remote_transaction_id</td>
<td><code>integer</code></td>
<td>optional - indicates a remote systems unique identifier for this transaction</td>
</tr>
<tr>
<td>created_at</td>
<td><code>string</code></td>
<td></td>
</tr>
</tbody></table>
<h3 id='get-last-transaction'>Get last Transaction</h3>
<p>This endpoint is designed to show the latest transaction for the given user in
json format. You can use this endpoint to find the user&#39;s current balance.</p>

<p>Please remember that if a user transaction is performed on the MyRewards 2.0
platform since a request is made over the api – this balance will be out of date.</p>

<p>On the server side a check will be made that the user_id you are requesting is</p>

<ul>
<li>a valid user</li>
<li>it is a user for the programme that your api key is scoped to.</li>
</ul>

<p>That is to say that you can only retrieve the last transaction for users of your
MyRewards Programme.</p>

<p>The remote_transaction_id is documented in the POST endpoint for creating
transactions, this value is optional, therefore can be <code>null</code></p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/users/123/transactions/last</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"transactions"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transaction_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"programme points"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"remote_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"your_id_here"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"date_time"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET /api/v2/users/{user_id}/transactions/last</code></p>
<h4 id='attributes-2'>Attributes</h4>
<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><code>integer</code></td>
<td>id of this transaction</td>
</tr>
<tr>
<td>user_id</td>
<td><code>integer</code></td>
<td>user id of the user this transaction belongs</td>
</tr>
<tr>
<td>description</td>
<td><code>string</code></td>
<td>transaction description</td>
</tr>
<tr>
<td>value</td>
<td><code>integer</code></td>
<td>can be positive or negative. value of points on the transaction</td>
</tr>
<tr>
<td>balance</td>
<td><code>integer</code></td>
<td>users running balance, at the time of the transaction</td>
</tr>
<tr>
<td>transaction_type</td>
<td><code>string</code></td>
<td>indicates the event which caused the transaction</td>
</tr>
<tr>
<td>remote_transaction_id</td>
<td><code>integer</code></td>
<td>optional - indicates a remote systems unique identifier for this transaction</td>
</tr>
<tr>
<td>created_at</td>
<td><code>string</code></td>
<td>datetime indicating when this points transaction was created</td>
</tr>
</tbody></table>
<h3 id='create-a-transaction'>Create a Transaction</h3>
<p><strong>Note this is &#39;v1&#39; endpoint.</strong> This endpoint is for either crediting or debiting points for a user.
This endpoint will respond with the MyRewards transaction id.
Points transactions have a type of either &#39;Credit&#39; or &#39;Debit&#39;.
A points transaction will also have a variety which will be one of:</p>

<table><thead>
<tr>
<th>Variety</th>
<th>Programme Points affecting?</th>
<th>Permitted Type</th>
</tr>
</thead><tbody>
<tr>
<td>Programme points</td>
<td>Yes</td>
<td>Either</td>
</tr>
<tr>
<td>Points Error</td>
<td>Yes</td>
<td>Either</td>
</tr>
<tr>
<td>Redemption</td>
<td>No</td>
<td>Debit only</td>
</tr>
<tr>
<td>Person2Person transfer</td>
<td>Yes</td>
<td>either (credit and debit must both be carried out for each user)</td>
</tr>
<tr>
<td>Order Cancellation</td>
<td>No</td>
<td>Credit only</td>
</tr>
<tr>
<td>Order Adjustment</td>
<td>No</td>
<td>either</td>
</tr>
<tr>
<td>Adjustment</td>
<td>Yes</td>
<td>either</td>
</tr>
<tr>
<td>Account Closure</td>
<td>Programme config dependant</td>
<td>Debit only</td>
</tr>
</tbody></table>

<p>Example below shows a transaction that will credit 100 points to a user debited from the programme balance. On the user&#39;s points statement a reason of &#39;Employee of the month&#39; will be shown.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v1/users/123/transactions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"transaction"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"variety"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Programme points"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Employee of the month"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"remote_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YOUR_REMOTE_TRANSACTION_ID"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request-3'>HTTP Request</h4>
<p><code>POST /api/v1/users/123/transactions</code></p>
<h4 id='parameters'>Parameters</h4>
<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>transaction_type</td>
<td><code>string</code></td>
<td>one of &#39;Credit&#39; or &#39;Debit&#39;</td>
</tr>
<tr>
<td>variety</td>
<td><code>string</code></td>
<td>Required - see above table and ensure validity with transaction_type</td>
</tr>
<tr>
<td>points</td>
<td><code>integer</code></td>
<td>Required - always greater than 0</td>
</tr>
<tr>
<td>reason</td>
<td><code>string</code></td>
<td>Required - free text up to 250 characters to describe transaction - appears on user points statement</td>
</tr>
<tr>
<td>remote_transaction_id</td>
<td><code>string</code></td>
<td>Optional - a value that can be used to identify this transaction by the client <em>Caution - there is no validation or constraints for data supplied under this key/field. This is left to the client system to enforce</em></td>
</tr>
</tbody></table>
<h4 id='error-responses'>Error responses</h4>
<p>Anything other than a 200 will mean that the transaction has failed to go through. It may or may not be appropriate to show only a generic message to indicate failure depending on the use case or level of automation. In either case it is recommended to log the error code and any body/message</p>

<ul>
<li> 204 User not found</li>
<li> 401 invalid key</li>
<li> 402 User does not have enough points</li>
<li> 406 Invalid Transaction</li>
<li> 412 Programme does not have enough points</li>
<li> 500 Server Error</li>
</ul>
<h2 id='user-groups'>User Groups</h2><h3 id='get-all-user-groups'>Get all User Groups</h3>
<p>A simple endpoint to fetch a list of user groups used for this programme. Only
accessible if the key has been granted access to users. Returns an array of
user_groups as a flat list, each user group will indicate it&#39;s parent id
enabling the client end of the API to re-construct the user group hierarchy. This
would be required if a registration_question is linked to a tier of user_groups
with a tier being a vertical &#39;slice&#39; down the hierarchy</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/user_groups</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dc comics"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"parent_id"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"position"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"justice league"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"parent_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"position"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/user_groups</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>user_group id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>user_group name</td>
</tr>
<tr>
<td>parent_id</td>
<td>integer</td>
<td>parent user_group id</td>
</tr>
<tr>
<td>default</td>
<td>boolean</td>
<td>indicates if this user_group is the default group for the programme</td>
</tr>
<tr>
<td>position</td>
<td>integer</td>
<td>position under the parent user_group, used for ordering</td>
</tr>
</tbody></table>
<h3 id='manage-user-groups'>Manage User Groups</h3>
<p>An endpoint to create a user group for this programme. Only accessible if the key
has been granted access to users. In order to create a usergroup a name is required.
This usergroup can be nested underneath another user group by passing the parent
user group id. Images can be uploaded to the user group by passing a publicly accessible image url. If
no position is passed then it will default to the bottom of the hierachy.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/user_groups</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>

{
  "name": "Example User Group",
  "position": 1,
  "parent_id": null,
  "image_url": "http://example_website.com/image.png"
}
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example User Group"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"parent_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example_hosted_image_url.com/image.png"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>POST /api/v2/user_groups</code></p>
<h4 id='parameters'>Parameters</h4>
<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td><code>string</code></td>
<td>Required - name of the user_group to be created</td>
</tr>
<tr>
<td>position</td>
<td><code>integer</code></td>
<td>position of the user_group in the hierachy</td>
</tr>
<tr>
<td>parent_id</td>
<td><code>integer</code></td>
<td>an optional id field, used if this user group should be nested underneath another</td>
</tr>
<tr>
<td>image_url</td>
<td><code>string</code></td>
<td>a url of user group image</td>
</tr>
</tbody></table>
<h2 id='user-group-gt-permissions'>User Group &gt; Permissions</h2><h3 id='get-usergroup-permissions'>GET UserGroup permissions</h3>
<p>An endpoint to fetch a list of permissions for a given user_group. Returns
an array of permissions with each permission displaying its parent permission
group name. This is to help identify different permissions when names are
the same across separate groups. It will also display whether the permission is
active for a given user_group.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/user_groups/:user_group_id/permissions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable log in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"General"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Order Rewards"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"Rewards module"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/user_groups/:user_group_id/permissions</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Required permission id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Required permission name</td>
</tr>
<tr>
<td>permission_group_name</td>
<td>string</td>
<td>Required parent permission group name</td>
</tr>
<tr>
<td>active</td>
<td>string</td>
<td>Required indicates if this permission is active for this user_group</td>
</tr>
</tbody></table>
<h3 id='update-a-user-group-39-s-permission-set'>Update a User Group&#39;s Permission set</h3>
<p>An endpoint to update the permissions associated with a give user_group. After querying
for the list of permissions associated with a given user_group, you can add or remove
a permission by simply changing the value associated with the <code>active</code> key from true
to false or vice-versa. You will be returned the updated list of permissions relative
to the given user_group</p>

<p>N.B. If updating a permission where the permission_group is not active the
change will be ignored</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PATCH</span> <span class="nn">/api/v2/user_groups/:user_group_id/permissions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>

{
  "permissions" : [
    {
      "id" : 1,
      "name" : "Enable log in",
      "permission_group_name" :  "General",
      "active" : false
    },
    {
      "id" : 2,
      "name" : "Order Rewards",
      "permission_group_name" :  "Rewards module",
      "active" : false
    }
  ]
}
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable log in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"General"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Order Rewards"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"Rewards module"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>PATCH /api/v2/user_groups/:user_group_id/permissions</code></p>
<h4 id='attributes-2'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>permission id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>permission name</td>
</tr>
<tr>
<td>permission_group_name</td>
<td>string</td>
<td>parent permission group name</td>
</tr>
<tr>
<td>active</td>
<td>string</td>
<td>indicates if this permission is active for this user_group</td>
</tr>
</tbody></table>
<h2 id='users'>Users</h2>
<p>In order to identify users, a programme will expect to use either username, email or mobile as a unique key to authenticate user with. As a consumer of this service, it is mandatory to supply a value for this field. Furthermore, there will be other fields that have been declared mandatory for your programme and user creation (POST) will fail if these values are not populated or provided.</p>
<h3 id='create-a-user'>Create a User</h3>
<p>In order to create a user account on the MyRewards 2.0 platform there is often
some information about the user we are creating that needs to be known before
the account can be successfully created.</p>

<p>Firstly, the user group that the user will be created as a member of must be
known, we provide an endpoint to query the usergroups for your programme and if
necessary to reconstruct the hierarchy for the usergroups see the usergroups
section.</p>

<p>Additionally, user accounts can have extra data required over and above the
minimal default fields for a user account. Typically, these take the form of
employee data, membership number etc and can be defined as part of your
programme. These extra data are called registration_questions, for more
information please see the registration_questions section.</p>

<p>Telephone and mobile number fields must be supplied in international format, meaning starting with a &#39;+&#39; followed by the international country code (I.e. the UK is 44) followed by at least 8 numeric characters.</p>

<p>Answers to the registration questions are provided in an array of objects, nested
under the key <code>registration_answers_attributes</code>. The nested objects themselves must
have the keys <code>registration_question_id</code> and <code>answer</code>. If the question allows multiple
answers, then the value for <code>answer</code> should be an array, as show in the example below.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/users</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bwayne"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bruce@wayneinc.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Mr"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"firstname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Bruce"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"lastname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"company"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne Inc"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CEO"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne Manor"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1007 Mountain Drive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"town"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Gotham"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"postcode"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"G1 1BM"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"county"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"New Jersey"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"country"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_of_birth"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1980-02-19"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"telephone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"+447876543210"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"mobile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"+447765432101"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tsandcs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"consented"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"marketing_consented"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_group_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"registration_answers_attributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"registration_question_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"answer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Because I'm Batman"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"registration_question_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"16"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"answer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Alfred"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bruce"</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">CREATED</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">Application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="s2">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bwayne"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bruce@wayneinc.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Mr"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"firstname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Bruce"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"lastname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"company"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne Inc"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CEO"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne Manor"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1007 Mountain Drive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"town"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Gotham"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"postcode"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"G1 1BM"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"county"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"New Jersey"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"country"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_of_birth"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1980-02-19"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"telephone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"+447876543210"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"mobile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"+447765432101"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tsandcs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"consented"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"marketing_consented"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_group_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"registration_answers_attributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"registration_question_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"answer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Because I'm Batman"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"registration_question_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"16"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"answer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Alfred"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>POST /api/v2/users</code></p>
<h4 id='parameters'>Parameters</h4>
<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>username</td>
<td><code>string</code></td>
<td>may be required, see user identification above, must be unique to the programme if required</td>
</tr>
<tr>
<td>email</td>
<td><code>string</code></td>
<td>valid email address and may be required, see user identification above, must be unique to the programme if required</td>
</tr>
<tr>
<td>title</td>
<td><code>string</code></td>
<td>salutation (Mr, Mrs, Ms, etc) no strict validation.</td>
</tr>
<tr>
<td>firstname</td>
<td><code>string</code></td>
<td>Required</td>
</tr>
<tr>
<td>lastname</td>
<td><code>string</code></td>
<td>Required</td>
</tr>
<tr>
<td>company</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>job_title</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>address_1</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>address_2</td>
<td><code>string</code></td>
<td>optional</td>
</tr>
<tr>
<td>town</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>postcode</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>county</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>country</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>date_of_birth</td>
<td><code>date</code></td>
<td>must be provided in reverse date format <code>YYYY-MM-DD</code>, Potentially required - see programme data requirements</td>
</tr>
<tr>
<td>telephone</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements - if supplied must be international format (starting with a &#39;+&#39; followed by international dialling code - UK is 44 - followed by at least 8 numeric characters)</td>
</tr>
<tr>
<td>mobile</td>
<td><code>string</code></td>
<td>Potentially required - see programme data requirements, if required, must be unique - if supplied must be international format (starting with a &#39;+&#39; followed by international dialling code - UK is 44 - followed by at least 8 numeric characters)</td>
</tr>
<tr>
<td>tsandcs</td>
<td><code>boolean</code></td>
<td>Required</td>
</tr>
<tr>
<td>user_group_id</td>
<td><code>integer</code></td>
<td>optional, will default to programme&#39;s default user_group, if not provided</td>
</tr>
<tr>
<td>registration_answers_attributes</td>
<td><code>array</code></td>
<td>array of hashes that contain a registration_question_id and an answer. Some or all of the registration questions may require answers. See registration_questions endpoint documentation</td>
</tr>
<tr>
<td>consented</td>
<td><code>boolean</code></td>
<td>Not required if programme access type is pre_registration with additional details, or SSO or if the programme doesn&#39;t have an active privacy policy.</td>
</tr>
<tr>
<td>marketing_consented</td>
<td><code>boolean</code></td>
<td>Can be true or false, not required if programme access type is pre_registration with additional details, or SSO or if the programme doesn&#39;t have an active privacy policy.</td>
</tr>
</tbody></table>
<h3 id='update-a-user'>Update a User</h3>
<p>The update user api is available to update user information. This uses the same
params as the create user api above.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PUT</span> <span class="nn">/api/v2/users/123</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"firstname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Joker"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"lastname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Hahaha"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">Application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="s2">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bwayne"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"bruce@wayneinc.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Mr"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"firstname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Joker"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"lastname"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Hahaha"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"company"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne Inc"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CEO"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Wayne Manor"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1007 Mountain Drive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"town"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Gotham"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"postcode"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"G1 1BM"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"county"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"New Jersey"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"country"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_of_birth"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1980-02-19"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"telephone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"+447876543210"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"mobile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"+447765432101"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tsandcs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_group_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"registration_answers_attributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"registration_question_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"answer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Because I'm Batman"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"registration_question_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"16"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"answer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Alfred"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>PUT /api/v2/users/{user_id}</code></p>

<p><code>PATCH /api/v2/users/{user_id}</code></p>
<h2 id='user-gt-permissions'>User &gt; Permissions</h2><h3 id='get-user-permissions'>GET User permissions</h3>
<p>An endpoint to fetch a list of permissions for a given user. Returns an array of permissions displaying it&#39;s parent
permissions group name. This is to help identify different permissions when names are the same across separate groups.
It will also display whether the permission is active for the given user and the state of the permission which can
be <code>Same As User Group</code> or if the permission has been overridden for that user: <code>Always Allow</code> or <code>Always Deny</code>.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/users/:user_id/permissions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable log in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"General"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Same As User Group"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Order Rewards"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"Rewards module"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Always Allow"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/users/:user_id/permissions</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Required permission id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Required permission name</td>
</tr>
<tr>
<td>permission_group_name</td>
<td>string</td>
<td>Required parent permission group name</td>
</tr>
<tr>
<td>active</td>
<td>string</td>
<td>Required indicates if this permission is active for this user</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>Required indicates whether the permission is granted or denied specifically for this user or if it is the same as the user_group</td>
</tr>
</tbody></table>
<h3 id='post-user-permissions'>POST User permissions</h3>
<p>A endpoint to update a list of permissions for a given user. Returns an array of permissions displaying it&#39;s parent
permissions group name. This is to help identify different permissions when names are the same across separate groups.
It will also display whether the permission is active for the given user and the state of the permission which can
be <code>Same As User Group</code> or if the permission has been overridden for that user: <code>Always Allow</code> or <code>Always Deny</code>.</p>

<p>The only value that this request will change is the <code>active</code> field. The other fields are present
to make it easier to move from the <code>GET</code> request to a <code>POST</code> without having to reformat
or delete much of the <code>GET</code> request response.</p>

<p>N.B. When specifying active = true this will set the permission to &quot;Always allow&quot;
setting to false will have the effect of &quot;Always deny&quot;</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PATCH</span> <span class="nn">/api/v2/users/:user_id/permissions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>

{
  "permissions" : [
    {
      "id" : 1,
      "name" : "Enable log in",
      "permission_group_name" :  "General",
      "active" : true
    },
    {
      "id" : 2,
      "name" : "Order Rewards",
      "permission_group_name" :  "Rewards module",
      "active" : false
    }
  ]
}
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable log in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"General"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Order Rewards"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"permission_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w">  </span><span class="s2">"Rewards module"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>PATCH /api/v2/users/:user_id/permissions</code></p>
<h4 id='attributes-2'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Required permission id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Required permission name</td>
</tr>
<tr>
<td>permission_group_name</td>
<td>string</td>
<td>Required parent permission group name</td>
</tr>
<tr>
<td>active</td>
<td>string</td>
<td>Required indicates if this permission is active for this user</td>
</tr>
</tbody></table>
<h1 id='extra-features'>Extra Features</h1><h2 id='data-widgets'>Data Widgets</h2>
<p>A Data Widget is used to show user specific information or data uploaded into
the data widgets area. </p>
<h3 id='get-all-data-widgets'>Get all Data Widgets</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/data_widgets</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4567</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some other text"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all data_widgets that belong to a programme (scoped by api key)</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/data_widgets</code></p>
<h3 id='get-a-data-widget-belonging-to-a-user'>Get a Data Widget belonging to a User</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/users/123/data_widgets/456</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Data widget name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_data_widget"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"this is some text"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Returns the specific data_widget &amp; user_data_widget data for the user specified { user_id } and the
{ id } specified.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET api/v2/users/{user_id}/data_widgets/{id}</code></p>
<h4 id='parameters'>Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>The ID of the user you want to retrieve data for</td>
</tr>
<tr>
<td>id</td>
<td>integer</td>
<td>The ID of the data_widget to retrieve</td>
</tr>
</tbody></table>
<h3 id='update-a-data-widget-belonging-to-a-user'>Update a Data Widget belonging to a User</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PUT</span> <span class="nn">/api/v2/users/123/data_widgets/456</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Body: </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"this is some new text"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Data widget name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_data_widget"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"this is some new text"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Update the data of the specific user_data_widget for the user specified { user_id } 
and the { id } specified.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>PUT api/v2/users/{user_id}/data_widgets/{id}</code></p>
<h4 id='parameters-2'>Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>The ID of the user you want to update data for</td>
</tr>
<tr>
<td>id</td>
<td>integer</td>
<td>The ID of the data_widget to retrieve</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>Your desired data string</td>
</tr>
</tbody></table>
<h2 id='target-trackers'>Target Trackers</h2>
<p>A target tracker is used to display a target value to a user and their achievement against that target.</p>
<h3 id='get-all-target-trackers'>Get All Target Trackers</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/target_trackers</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4567</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some other text"</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"£"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all target_trackers that belong to a programme (scoped by api key)</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/target_trackers</code></p>
<h3 id='get-a-target-tracker-39-s-values-belonging-to-a-user'>Get a Target Tracker&#39;s values belonging to a User</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/users/123/target_trackers/456</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Team"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"target_tracker_users"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"target_value"</span><span class="p">:</span><span class="w"> </span><span class="mf">2000.00</span><span class="p">,</span><span class="w">
    </span><span class="s2">"current_value"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.00</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Returns the specific target_tracker &amp; target_tracker_user data for the { user_id } and
{ id } specified.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET api/v2/users/{user_id}/target_trackers/{id}</code></p>
<h4 id='parameters'>Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>The ID of the user you want to retrieve target_tracker data for</td>
</tr>
<tr>
<td>id</td>
<td>integer</td>
<td>The ID of the target_tracker to retrieve</td>
</tr>
</tbody></table>
<h3 id='update-a-target-tracker-belonging-to-a-user'>Update a Target Tracker belonging to a User</h3>
<blockquote>
<p>Header: </p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PUT</span> <span class="nn">/api/v2/users/123/target_trackers/456</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Body: </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"target_value"</span><span class="p">:</span><span class="w"> </span><span class="mf">2000.00</span><span class="p">,</span><span class="w">
  </span><span class="s2">"current_value"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.00</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Team"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"target_tracker_users"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"target_value"</span><span class="p">:</span><span class="w"> </span><span class="mf">2000.00</span><span class="p">,</span><span class="w">
    </span><span class="s2">"current_value"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.00</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Update the attributes of the specific target_tracker_user for the specified { user_id } 
and the { id }.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>PUT api/v2/users/{user_id}/target_trackers/{id}</code></p>
<h4 id='parameters-2'>Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>integer</td>
<td>The ID of the user you want to update target_tracker_user data for</td>
</tr>
<tr>
<td>id</td>
<td>integer</td>
<td>The ID of the target_tracker to retrieve</td>
</tr>
<tr>
<td>target_value</td>
<td>float</td>
<td>Your desired target_value</td>
</tr>
<tr>
<td>current_value</td>
<td>float</td>
<td>Your desired current_value</td>
</tr>
</tbody></table>
<h1 id='performance-module'>Performance Module</h1><h2 id='allocated-claims'>Allocated Claims</h2><h3 id='view-allocated-claims'>View Allocated Claims</h3>
<p>Endpoint to view allocated claims against a specific promotion. Claims can be scoped down via passed in parameters. Only 100 records are returned at a time.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/performance/promotions/1/allocated_claims</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at_start_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/01/2020"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at_end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"02/02/2020"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_of_sale_start_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/01/2020"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_of_sale_end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"02/02/2020"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">Ok</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"allocated_claims"</span><span class="p">:</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/02/2018"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA1234"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/02/2018"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"some_custom_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some custom answer"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/02/2018"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA1234"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/02/2018"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"some_custom_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"another custom answer"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/performance/promotions/1/allocated_claims</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>promotion_id</td>
<td><code>integer</code></td>
<td>The ID of the promotion claim is for. Mandatory.</td>
</tr>
<tr>
<td>user_group_id</td>
<td><code>integer</code></td>
<td>ID of a user_group that allocated_claims belong to, used for scoping down results. Optional</td>
</tr>
<tr>
<td>company_id</td>
<td><code>integer</code></td>
<td>ID of a company that allocated_claims belong to, used for scoping down results. Optional</td>
</tr>
<tr>
<td>status</td>
<td><code>string</code></td>
<td>Required Status for the allocated_claims that are returned, used for scoping down results. Optional</td>
</tr>
<tr>
<td>created_at_start_date</td>
<td><code>string</code></td>
<td>A parameter for scoping allocated_claims that were created from that date onwards. Optional.</td>
</tr>
<tr>
<td>created_at_end_date</td>
<td><code>string</code></td>
<td>A parameter for scoping allocated_claims that were created before the given date. Optional.</td>
</tr>
<tr>
<td>date_of_sale_start_date</td>
<td><code>string</code></td>
<td>A parameter for scoping allocated_claims with a date_of_sale from the given date onwards. Optional.</td>
</tr>
<tr>
<td>date_of_sale_end_date</td>
<td><code>string</code></td>
<td>A parameter for scoping allocated_claims with a date_of_sale before the given date. Optional.</td>
</tr>
<tr>
<td>page</td>
<td><code>integer</code></td>
<td>The requested page number. Defaults to page 1 if not supplied. Optional.</td>
</tr>
</tbody></table>
<h3 id='decline-allocated-claims'>Decline Allocated Claims</h3>
<p>Endpoint to decline a given allocated claim.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/performance/promotions/1/allocated_claims/1/decline</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"reason_for_decline_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An id for a decline reason"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"reason_for_decline_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Some reason text string"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div><h4 id='http-request-2'>HTTP Request</h4>
<p><code>POST /api/v2/performance/promotions/1/allocated_claims/1/decline</code></p>
<h4 id='attributes-2'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>reason_for_decline_id</td>
<td><code>string</code></td>
<td>The ID of a reason belonging to the promotion. Mandatory if decline reasons enabled on programme.</td>
</tr>
<tr>
<td>reason_for_decline_text</td>
<td><code>string</code></td>
<td>A text string for a decline reason, can only be provided if the promotion allows free text decline reasons. Optional.</td>
</tr>
</tbody></table>
<h3 id='create-allocated-claims'>Create Allocated Claims</h3>
<p>Endpoint to create allocated claims against specific promotion. Claims are created by using the <code>data_field</code> names from above as key/value pairs. Your request must include <code>user_group_id</code> or <code>company_id,</code> depending on the promotion configuration.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/performance/promotions/1/allocated_claims</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"allocated_claims"</span><span class="p">:</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/02/2018"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA1234"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"some_custom_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some custom answer"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"03/12/2017"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BBB4567"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="s2">"some_other_custom_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some other custom answer"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"allocated_claims"</span><span class="p">:</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01/02/2018"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA1234"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"some_custom_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some custom answer"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"03/12/2017"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BBB4567"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"company_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="s2">"some_other_custom_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some other custom answer"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div><h4 id='http-request-3'>HTTP Request</h4>
<p><code>POST /api/v2/performance/promotions/1/allocated_claims</code></p>
<h4 id='attributes-3'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>promotion_id</td>
<td><code>integer</code></td>
<td>The ID of the promotion claim is for.</td>
</tr>
<tr>
<td>sale_date</td>
<td><code>date</code></td>
<td>The date when this piece of data was created. Mandatory.</td>
</tr>
<tr>
<td>product_or_activity_ref</td>
<td><code>string</code></td>
<td>The SKU for the performance product to claim against</td>
</tr>
<tr>
<td>quantity</td>
<td><code>integer</code></td>
<td>The quantity of products sold. Mandatory.</td>
</tr>
<tr>
<td>user_group_id</td>
<td><code>integer</code></td>
<td>ID of the user group claim relates to (either this or company_id needs to be supplied)</td>
</tr>
<tr>
<td>company_id</td>
<td><code>integer</code></td>
<td>ID of the MyRewards company claim related to (either this or user_group_id needs to be supplied)</td>
</tr>
</tbody></table>

<p>You will also need to provide any custom data fields as extra keys for each piece of claim data in snake case format which is provided in the name field for the <a href="#list-all-data-fields">GET List Data Fields</a> for a Promotion.</p>

<p>Eg:</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>some_custom_field</td>
<td><code>custom field type</code></td>
<td>A custom answer for this field</td>
</tr>
</tbody></table>
<h2 id='self-claims'>Self Claims</h2><h3 id='get-self-claims'>Get Self Claims</h3>
<p>Endpoint to get self claims against a specific self-claim promotion. Claims can be filtered down via passed-in parameters. If no URL parameters are provided then all claims against the requested promotion are returned. Results are paginated at 100 records per page.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/performance/promotions/{promotion_id}/self_claims</code></p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/performance/promotions/1/self_claims</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">Ok</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"self_claims"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4099</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-29"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"p1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">505</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"declined_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-30T14:15:25.000+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-07T16:41:19.000+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"questions_answers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"1174"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 1 - free text"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1175"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 2 - lov r"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1176"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 3 - lov c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1177"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 4 - lov s"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1178"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 5 - date"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1179"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 6 - upload"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4104</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-02"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"p1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">505</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"approved"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"declined_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-11T14:15:32.000+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-11T14:15:32.000+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"questions_answers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"1174"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 1 - free text"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1175"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 2 - lov r"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1176"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 3 - lov c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1177"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 4 - lov s"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1178"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 5 - date"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1179"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 6 - upload"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4117</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-23"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"p1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">505</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"declined"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"declined_reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Not good enough"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-23T14:15:32.000+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-28T10:41:13.000+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"questions_answers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"1174"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 1 - free text"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1175"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 2 - lov r"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1176"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 3 - lov c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1177"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 4 - lov s"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1178"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 5 - date"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"1179"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 6 - upload"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='request-parameters'>Request Parameters</h4><h5 id='url-parameters'>URL Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td><code>string</code></td>
<td>Status of the claims to be returned. Optional</td>
</tr>
<tr>
<td>product_or_activity_ref</td>
<td><code>integer</code></td>
<td>The reference of the product or activity you wish to return claims for. Optional.</td>
</tr>
<tr>
<td>user_id</td>
<td><code>integer</code></td>
<td>ID of a user that claims were made by. Optional</td>
</tr>
<tr>
<td>created_at_start_date</td>
<td><code>string</code></td>
<td>A parameter for scoping claims that were created from that date onwards. Optional.</td>
</tr>
<tr>
<td>created_at_end_date</td>
<td><code>string</code></td>
<td>A parameter for scoping claims that were created on or before the given date. Optional.</td>
</tr>
<tr>
<td>date_of_sale_start_date</td>
<td><code>string</code></td>
<td>A parameter for scoping claims with a date_of_sale from the given date onwards. Optional.</td>
</tr>
<tr>
<td>date_of_sale_end_date</td>
<td><code>string</code></td>
<td>A parameter for scoping claims with a date_of_sale on or before the given date. Optional.</td>
</tr>
<tr>
<td>page</td>
<td><code>integer</code></td>
<td>The requested page number. Defaults to page 1 if not supplied. Optional.</td>
</tr>
</tbody></table>
<h4 id='response-attributes'>Response Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><code>integer</code></td>
<td>the id of the claim</td>
</tr>
<tr>
<td>sale_date</td>
<td><code>string</code></td>
<td>the date of sale as provided on the claim</td>
</tr>
<tr>
<td>product_or_activity_ref</td>
<td><code>string</code></td>
<td>the reference of the claimed product or activity</td>
</tr>
<tr>
<td>quantity</td>
<td><code>integer</code></td>
<td>the number of items claimed</td>
</tr>
<tr>
<td>points_value</td>
<td><code>integer</code></td>
<td>the number of points the claim is worth</td>
</tr>
<tr>
<td>user_id</td>
<td><code>integer</code></td>
<td>the id of the user who made the claim</td>
</tr>
<tr>
<td>status</td>
<td><code>string</code></td>
<td>the status of the claim - one of: pending, approved, declined</td>
</tr>
<tr>
<td>declined_reason</td>
<td><code>string</code></td>
<td>optional - a string indicating the reason for decline if the claim is declined</td>
</tr>
<tr>
<td>created_at</td>
<td><code>string</code></td>
<td>the date that the claim was submitted</td>
</tr>
<tr>
<td>updated_at</td>
<td><code>string</code></td>
<td>the date that the claim was last updated</td>
</tr>
<tr>
<td>questions_answers</td>
<td><code>object</code></td>
<td>an object containing questions identified by their id, along with a child object containing the name of the question, and the answer provided for that question</td>
</tr>
</tbody></table>
<h3 id='decline-self-claim'>Decline Self Claim</h3>
<p>Endpoint to decline a specified claim.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>POST /api/v2/performance/promotions/{promotion_id}/self_claims/{claim_id}/decline</code></p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/performance/promotions/1/self_claims/123/decline</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"reason_for_decline_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"reason_for_decline_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Some reason text string"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">Ok</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4117</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-23"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"p1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"points_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">505</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"declined"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"declined_reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Not good enough"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-23T14:15:32.000+00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-28T10:41:13.000+00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"questions_answers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"1174"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 1 - free text"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1175"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 2 - lov r"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1176"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 3 - lov c"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1177"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 4 - lov s"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1178"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 5 - date"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1179"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 6 - upload"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div><h4 id='request-parameters-2'>Request Parameters</h4><h5 id='body-parameters'>Body Parameters</h5>
<p>If decline reasons are active on the promotion, then one of <code>reason_for_decline_id</code> or <code>reason_for_decline_text</code>, but not both, should be provided when declining a claim.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>reason_for_decline_id</td>
<td><code>integer</code></td>
<td>Required conditional - The ID of a reason for decline belonging to the promotion.</td>
</tr>
<tr>
<td>reason_for_decline_text</td>
<td><code>string</code></td>
<td>Required conditional - A text string of a reason for decline. Can only be provided if the promotion allows free text decline reasons.</td>
</tr>
</tbody></table>
<h3 id='approve-self-claim'>Approve Self Claim</h3>
<p>Endpoint to approve a specified claim.</p>
<h4 id='http-request-3'>HTTP Request</h4>
<p><code>POST /api/v2/performance/promotions/{promotion_id}/self_claims/{claim_id}/approve</code></p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/performance/promotions/1/self_claims/123/approve</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"points_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">Ok</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4117</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sale_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-23"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"p1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"points_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">505</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"approved"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"declined_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-23T14:15:32.000+00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-28T10:41:13.000+00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"questions_answers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"1174"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 1 - free text"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1175"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 2 - lov r"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1176"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 3 - lov c"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1177"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 4 - lov s"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1178"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 5 - date"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"1179"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom q 6 - upload"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div><h4 id='request-parameters-3'>Request Parameters</h4><h5 id='body-parameters-2'>Body Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>points_value</td>
<td><code>integer</code></td>
<td>Optional. If provided, the value of points awarded for the claim will be updated to match the value supplied. If the value exceeds the available programme budget, an error will be returned and the claim will not be approved.</td>
</tr>
</tbody></table>
<h2 id='data-fields'>Data Fields</h2><h3 id='list-all-data-fields'>List all Data Fields</h3>
<p>A simple endpoint to fetch a list of the data fields for a performance module
enabled programme scoped to a Promotion. Returns an array of data fields as a flat list.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/performance/promotions/1/data_fields</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">196</span><span class="p">,</span><span class="w">
    </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"superpower"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Superpower"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list_values"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Super-strength</span><span class="se">\r\n</span><span class="s2">Flight</span><span class="se">\r\n</span><span class="s2">Other"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-14T13:34:03.000+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-14T13:34:03.000+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">197</span><span class="p">,</span><span class="w">
    </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hero_name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hero name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"free_text"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-14T13:35:03.000+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-04-14T13:35:03.000+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4><div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/performance/promotions/1/data_fields</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"customer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bob"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"invoice_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-01"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"product_or_activity_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PRE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value_of_sale"</span><span class="p">:</span><span class="w"> </span><span class="mf">100.35</span><span class="p">,</span><span class="w">
      </span><span class="s2">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.doe@noemail.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><code>integer</code></td>
<td>data_field id</td>
</tr>
<tr>
<td>promotion_id</td>
<td><code>integer</code></td>
<td>promotion id</td>
</tr>
<tr>
<td>name</td>
<td><code>string</code></td>
<td>data_field name in snake case format.</td>
</tr>
<tr>
<td>label</td>
<td><code>string</code></td>
<td>data_field label.</td>
</tr>
<tr>
<td>mandatory</td>
<td><code>boolean</code></td>
<td>Whether this field is required</td>
</tr>
<tr>
<td>field_type</td>
<td><code>string</code></td>
<td>One of: &#39;free_text&#39;, &#39;numeric&#39;, &#39;list_values&#39;, &#39;date&#39;</td>
</tr>
<tr>
<td>answers</td>
<td><code>string</code></td>
<td>A &#39;\r\n&#39; separated list of allowed answers</td>
</tr>
<tr>
<td>created_at</td>
<td><code>date</code></td>
<td>The time at which this field was created</td>
</tr>
<tr>
<td>updated_at</td>
<td><code>date</code></td>
<td>The time at which this field was last updated</td>
</tr>
<tr>
<td>position</td>
<td><code>integer</code></td>
<td>Position of the data field within the form</td>
</tr>
</tbody></table>
<h2 id='performance-categories'>Performance Categories</h2><h3 id='list-performance-categories'>List Performance Categories</h3>
<p>Endpoint to fetch a list of the performance categories for a performance module enabled programme</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/performance/performance_categories</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="s">[</span>
<span class="s">    {</span>
<span class="s">        "id": 1,</span>
<span class="s">        "name": "Category Name 1"</span>
<span class="s">    },</span>
<span class="s">    {</span>
<span class="s">        "id": 2,</span>
<span class="s">        "name": "Category Name 2"</span>
<span class="s">    }</span>
<span class="s">]</span>
</code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>GET /api/v2/performance/performance_categories</code></p>
<h4 id='parameters'>Parameters</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>The id of the performance category</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>The name of the performance category</td>
</tr>
</tbody></table>
<h2 id='performance-products'>Performance Products</h2><h3 id='creating-a-product'>Creating a Product</h3>
<p>Endpoint to create performance products for a programme with the performance module enabled.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/performance/performance_product_batches</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"performance_products"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"performance_category_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Product 1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc1236"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some description"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"performance_category_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Product 2"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc5766"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some description"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"peformance_category_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Product 1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc1236"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some description"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"peformance_category_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Product 2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc5766"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some description"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>POST /api/v2/performance/performance_product_batches</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>performance_category_id</td>
<td><code>integer</code></td>
<td>The id of the category the product will belong to. This must be valid for your programme</td>
</tr>
<tr>
<td>name</td>
<td><code>string</code></td>
<td>The name of the product. Must be unique</td>
</tr>
<tr>
<td>ref</td>
<td><code>string</code></td>
<td>The reference for the product. Must be unique</td>
</tr>
<tr>
<td>product_type</td>
<td><code>string</code></td>
<td>Must be either &#39;product&#39; or &#39;activity&#39;</td>
</tr>
<tr>
<td>value</td>
<td><code>integer</code></td>
<td>A positive two digit number. Must be the value in RRP or the cost value of the product in your programme&#39;s currency. If the product_type is &#39;product&#39;, this must be provided</td>
</tr>
<tr>
<td>description</td>
<td><code>text</code></td>
<td>Some text describing the product. Optional</td>
</tr>
</tbody></table>
<h3 id='updating-a-product'>Updating a Product</h3>
<p>Endpoint to update performance products for a programme with the performance module enabled.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PUT</span> <span class="nn">/api/v2/performance/performance_product_batches</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="s">PATCH /api/v2/performance/performance_product_batches HTTP/1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"performance_products"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"performance_category_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Update Name"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc1236"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Updated Description"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"peformance_category_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Updated name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc1236"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Updated description"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><h4 id='http-request-2'>HTTP Request</h4><div class="highlight"><pre class="highlight plaintext"><code>PUT /api/v2/performance/performance_product_batches
PATCH /api/v2/performance/performance_product_batches
</code></pre></div><h4 id='attributes-2'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><code>integer</code></td>
<td>The id of the performance product to be updated</td>
</tr>
<tr>
<td>performance_category_id</td>
<td><code>integer</code></td>
<td>The id of the category the product will belong to. This must be valid for your programme</td>
</tr>
<tr>
<td>name</td>
<td><code>string</code></td>
<td>The name of the product. Must be unique</td>
</tr>
<tr>
<td>ref</td>
<td><code>string</code></td>
<td>The reference for the product. Must be unique</td>
</tr>
<tr>
<td>product_type</td>
<td><code>string</code></td>
<td>Must be either &#39;product&#39; or &#39;activity&#39;</td>
</tr>
<tr>
<td>value</td>
<td><code>integer</code></td>
<td>A positive two digit number. Must be the value in RRP or the cost value of the product in your programme&#39;s currency. If the product_type is &#39;product&#39;, this must be provided</td>
</tr>
<tr>
<td>description</td>
<td><code>text</code></td>
<td>Some text describing the product. Optional</td>
</tr>
</tbody></table>
<h2 id='sales-data'>Sales Data</h2><h3 id='create-sales-data'>Create Sales Data</h3>
<p>Endpoint to create claims against specific promotion. Claims are created by using the data_field names from above as key/value pairs.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/performance/data</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">468</span><span class="p">,</span><span class="w">
        </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer_name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list_values"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bob</span><span class="se">\r\n</span><span class="s2">Harry</span><span class="se">\r\n</span><span class="s2">Suzy"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:50:50.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-26T12:51:15.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">464</span><span class="p">,</span><span class="w">
        </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invoice_date"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invoice date"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:51:04.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">465</span><span class="p">,</span><span class="w">
        </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product_or_activity_ref"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Product or Activity Ref"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"free_text"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">466</span><span class="p">,</span><span class="w">
        </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"quantity"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Quantity"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"numeric"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">567</span><span class="p">,</span><span class="w">
        </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_of_sale"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Value of sale"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"numeric"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-26T12:52:48.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-02-07T15:03:41.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">467</span><span class="p">,</span><span class="w">
        </span><span class="s2">"promotion_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"username"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Username"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mandatory"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"free_text"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"answers"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-10T08:43:59.000+00:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">CREATED</span>
</code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>POST /api/v2/performance/promotions/1/data</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>sale_date</td>
<td><code>date</code></td>
<td>The date when this piece of data was created</td>
</tr>
<tr>
<td>product_or_activity_ref</td>
<td><code>string</code></td>
<td>The SKU for the performance product to claim against</td>
</tr>
<tr>
<td>quantity</td>
<td><code>integer</code></td>
<td>The quantity of products sold</td>
</tr>
<tr>
<td>username</td>
<td><code>string</code></td>
<td>The username or email for the user to assign points to ( Either this or the <code>user_id</code> field needs to be supplied. )</td>
</tr>
<tr>
<td>user_id</td>
<td><code>user_id</code></td>
<td>The MyRewards user ID for the user to assign points to ( Either this or the <code>username</code> field needs to be supplied. )</td>
</tr>
</tbody></table>

<p>You will also need to provide any custom data fields as extra keys for each piece of claim data in snake case format which is provided in the name field for the GET List Data Fields for a Promotion. The Promotion ID will need to correspond to an existing &amp; valid promotion</p>

<p>If one record in a set being uploaded fails to be created either by being invalid or through a programme not having enough points - all records in the request will fail to be created</p>
<h1 id='recognition-module'>Recognition Module</h1><h2 id='nominations'>Nominations</h2><h3 id='update-a-nomination-39-s-status'>Update a Nomination&#39;s status</h3>
<p>An endpoint to update a status of a nomination for a given campaign, by passing
a status parameter. A valid approver for the nomination must also be provided.
You will be returned the updated JSON for the given nomination.</p>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PATCH</span> <span class="nn">/api/v2/campaigns/:campaign_id/nominations/:id</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"transition"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"approve"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"approver"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"approved_l1"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PATCH</span> <span class="nn">/api/v2/campaigns/:campaign_id/nominations/:id</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"transition"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"decline"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"approver"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="s2">"declined_reason"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Already nominated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"declined_l1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"declined_reason"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Already nominated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='http-request'>HTTP Request</h4>
<p><code>PATCH /api/v2/campaigns/:campaign_id/nominations/:id</code></p>
<h4 id='url-parameters'>URL Parameters</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><code>integer</code></td>
<td>(required) campaign_award_request id</td>
</tr>
<tr>
<td>campaign_id</td>
<td><code>integer</code></td>
<td>(required) campaign id</td>
</tr>
</tbody></table>
<h4 id='body-parameters'>Body Parameters</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>approver</td>
<td><code>integer</code></td>
<td>(required) the approver&#39;s user id</td>
</tr>
<tr>
<td>reason</td>
<td><code>string</code></td>
<td>(optional) string which can be provided when declining a nomination</td>
</tr>
<tr>
<td>transition</td>
<td><code>string</code></td>
<td>(required) a valid transition to be performed on the award (<code>approve</code> or <code>decline</code> only)</td>
</tr>
</tbody></table>
<h4 id='approver-information'>Approver Information</h4>
<p>The approver should be a valid approver for the nomination, and for the approver level.</p>
<h4 id='reason-information'>Reason Information</h4>
<p>When declining a nomination an optional string can be provided. This is saved to
the nomination when it is declined.</p>
<h4 id='state-transition-information'>State Transition Information</h4>
<p>Nominations can only transition to a state allowed by its current
state. For example an award with state &#39;pending_l1&#39; can transition to
&#39;approved_l1&#39; but not to &#39;approved_l2&#39;. Only &quot;approve&quot; or &quot;decline&quot; can be provided to the API.</p>
<h1 id='reward-module'>Reward Module</h1><h2 id='instant-point-vouchers-ipv'>Instant Point Vouchers (IPV)</h2><h3 id='create-an-ipv'>Create an IPV</h3>
<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/api/v2/reward/codes</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Body:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Competition winner."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expiry_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-12-31"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"send_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.doe@noemail.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response: </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Competition winner."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expiry_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-12-31"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"send_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"john.doe@noemail.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"code_value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"XXXX-YYYY-ZZZZ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"batch_reference"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SSSS"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"issued"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"programme_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Generate Reward IPV codes for Programmes with the Rewards Module. </p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>POST /api/v2/reward/codes</code></p>
<h4 id='attributes'>Attributes</h4>
<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Info</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>integer</td>
<td>Required, must be a positive integer. Points value of the IPV</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>Optional, text field</td>
</tr>
<tr>
<td>expiry_date</td>
<td>date</td>
<td>Required, must be in the future and in the format <code>YYYY-MM-DD</code></td>
</tr>
<tr>
<td>send_email</td>
<td>string</td>
<td>Optional, valid email address to which the code will be sent. If provided, the &#39;Send a code&#39; email messages must be configured. Response will have <code>issued</code> set to <code>true</code></td>
</tr>
</tbody></table>
<h3 id='get-an-ipv'>Get an IPV</h3>
<blockquote>
<p>Header: </p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">GET</span> <span class="nn">/api/v2/reward/codes/{id}</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Response: </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Competition winner."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expiry_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-12-31"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"send_email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"john.doe@noemail.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"code_value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"XXXX-YYYY-ZZZZ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"batch_reference"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SSSS"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"issued"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"programme_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>To view the details of an IPV code.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>GET /api/v2/reward/codes/{id}</code></p>
<h2 id='points-overrides'>Points Overrides</h2><h3 id='update-a-points-override'>Update a points override</h3>
<p>Set or update a points override for a product within your programme.</p>

<aside>
Note that this endpoint uses IDs from
<a href="https://docs.gps.my-rewards.co.uk/#products-list-all-products">GPS</a>,
and not MyRewards
</aside>

<p>If MyRewards has already imported the product from GPS, the points override will take effect on your programme immediately. Otherwise, you will need to wait for the daily sync to have run before the override takes effect.</p>
<h4 id='http-request'>HTTP Request</h4>
<p><code>PUT /api/v2/points_overrides/{gps_product_id}</code></p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">PUT</span> <span class="nn">/api/v2/points_overrides/1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div>
<blockquote>
<p>Body:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"programme_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gps_product_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5678</span><span class="p">,</span><span class="w">
    </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='request-parameters'>Request Parameters</h4><h5 id='url-parameters'>URL Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>gps_product_id</td>
<td><code>integer</code></td>
<td>The product ID (<strong>from GPS</strong>) whose points you want to override</td>
</tr>
</tbody></table>
<h5 id='body-parameters'>Body Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>points</td>
<td><code>integer</code></td>
<td>The points override you want to set. Must be &gt;= 0</td>
</tr>
</tbody></table>
<h3 id='delete-a-points-override'>Delete a points override</h3>
<p>Remove a points override for a product within your programme.</p>

<aside>
Note that this endpoint uses IDs from
<a href="https://docs.gps.my-rewards.co.uk/#products-list-all-products">GPS</a>,
and not MyRewards
</aside>
<h4 id='http-request-2'>HTTP Request</h4>
<p><code>DELETE /api/v2/points_overrides/{gps_product_id}</code></p>

<blockquote>
<p>Header:</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">DELETE</span> <span class="nn">/api/v2/points_overrides/1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Token token=xxx</span>
</code></pre></div>
<blockquote>
<p>Response (override found for product id):</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">No Content</span>
</code></pre></div>
<blockquote>
<p>Response (no override found for product id):</p>
</blockquote>
<div class="highlight"><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">404</span> <span class="ne">Not Found</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"No override found for product id"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id='request-parameters-2'>Request Parameters</h4><h5 id='url-parameters-2'>URL Parameters</h5>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>gps_product_id</td>
<td><code>integer</code></td>
<td>The product ID (<strong>from GPS</strong>) whose points you want to override</td>
</tr>
</tbody></table>
<h1 id='simple-single-sign-on'>Simple Single Sign on</h1>
<p>Our SSO uses <a href="https://en.wikipedia.org/wiki/SAML_2.0">SAML 2.0</a> to facilitate IdP-initiated Single Sign On to a MyRewards Programme</p>

<p>In this case MyRewards acts as a Service Provider (SP) for a given programme</p>

<p>The client platform is acting as an Identity Provider (IdP)</p>
<h3 id='process-flow'>Process flow</h3>
<ol>
<li>User is challenged to authenticate at the IdP side</li>
<li>User Logs in to the IdP</li>
<li>User selects access to SP</li>
<li>IdP Responds with assertion to user</li>
<li>User&#39;s browser <code>POST</code>s this assertion to the MyRewards programme</li>
<li>Session established on MyRewards and user is granted access</li>
</ol>
<h3 id='the-assertion'>The Assertion</h3>
<blockquote>
<p>Example SAML assertion:</p>
</blockquote>
<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;samlp:Response</span> <span class="na">ID=</span><span class="s">"_UNIQUE-ID"</span> <span class="na">Version=</span><span class="s">"2.0"</span> <span class="na">IssueInstant=</span><span class="s">"2020-01-01T00:00:00.000000Z"</span> <span class="na">Destination=</span><span class="s">"https://programme-name.com/saml/consume"</span> <span class="na">xmlns=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span><span class="nt">&gt;</span>
 <span class="c">&lt;!-- [1] --&gt;</span>
 <span class="nt">&lt;saml:Issuer</span> <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:entity"</span> <span class="na">xmlns=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span><span class="nt">&gt;</span>
  https://www.client-company.com
 <span class="nt">&lt;/saml:Issuer&gt;</span>

 <span class="c">&lt;!-- [2] --&gt;</span>
 <span class="nt">&lt;ds:Signature</span> <span class="na">xmlns:ds=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ds:SignedInfo&gt;</span>
   <span class="nt">&lt;ds:CanonicalizationMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xmlexc-c14n#"</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;ds:SignatureMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#rsasha1"</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;ds:Reference</span> <span class="na">URI=</span><span class="s">"#_UNIQUE-ID"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ds:Transforms&gt;</span>
     <span class="nt">&lt;ds:Transform</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#enveloped-signature"</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;ds:Transform</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-excc14n#"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ds:Transforms&gt;</span>
    <span class="nt">&lt;ds:DigestMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#sha1"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ds:DigestValue&gt;</span>...digestValue...<span class="nt">&lt;/ds:DigestValue&gt;</span>
   <span class="nt">&lt;/ds:Reference&gt;</span>
  <span class="nt">&lt;/ds:SignedInfo&gt;</span>
  <span class="nt">&lt;ds:SignatureValue&gt;</span>...signatureValue...<span class="nt">&lt;/ds:SignatureValue&gt;</span>
  <span class="nt">&lt;ds:KeyInfo&gt;</span>
   <span class="nt">&lt;ds:X509Data&gt;</span>
    <span class="nt">&lt;ds:X509Certificate&gt;</span>...Certificate...<span class="nt">&lt;/ds:X509Certificate&gt;</span>
   <span class="nt">&lt;/ds:X509Data&gt;</span>
  <span class="nt">&lt;/ds:KeyInfo&gt;</span>
 <span class="nt">&lt;/ds:Signature&gt;</span>

 <span class="nt">&lt;samlp:Status&gt;</span>
  <span class="nt">&lt;samlp:StatusCode</span> <span class="na">Value=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:status:Success"</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/samlp:Status&gt;</span>

 <span class="nt">&lt;saml:Assertion</span> <span class="na">Version=</span><span class="s">"2.0"</span> <span class="na">ID=</span><span class="s">"_UNIQUE-ID"</span> <span class="na">IssueInstant=</span><span class="s">"2020-01-01T00:00:00.000000Z"</span> <span class="na">xmlns=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- [1] --&gt;</span>
  <span class="nt">&lt;saml:Issuer</span> <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:entity"</span><span class="nt">&gt;</span>
   https://www.client-company.com
  <span class="nt">&lt;/saml:Issuer&gt;</span>

  <span class="c">&lt;!-- [3] --&gt;</span>
  <span class="nt">&lt;saml:Subject&gt;</span>
   <span class="nt">&lt;saml:NameID</span> <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"</span><span class="nt">&gt;</span>Principal ID<span class="nt">&lt;/saml:NameID&gt;</span>
  <span class="nt">&lt;/saml:Subject&gt;</span>

  <span class="c">&lt;!-- [4] --&gt;</span>
  <span class="nt">&lt;saml:Conditions</span> <span class="na">NotBefore=</span><span class="s">"2020-01-01T00:00:00.000000Z"</span> <span class="na">NotOnOrAfter=</span><span class="s">"2020-01-01T02:00:00.000000Z"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;saml:AudienceRestriction&gt;</span>
    <span class="nt">&lt;saml:Audience&gt;</span>https://programme-name.com/saml/metadata<span class="nt">&lt;/saml:Audience&gt;</span>
   <span class="nt">&lt;/saml:AudienceRestriction&gt;</span>
  <span class="nt">&lt;/saml:Conditions&gt;</span>

  <span class="nt">&lt;saml:AuthnStatement</span> <span class="na">AuthnInstant=</span><span class="s">"2020-01-01T00:00:00.000000Z"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;saml:AuthnContext&gt;</span>
    <span class="nt">&lt;saml:AuthnContextClassRef&gt;</span>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport<span class="nt">&lt;/saml:AuthnContextClassRef&gt;</span>
   <span class="nt">&lt;/saml:AuthnContext&gt;</span>
  <span class="nt">&lt;/saml:AuthnStatement&gt;</span>

  <span class="nt">&lt;saml:AttributeStatement&gt;</span>
   <span class="nt">&lt;saml:Attribute</span> <span class="na">Name=</span><span class="s">"uid"</span> <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:basic"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:q1=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">p6:type=</span><span class="s">"q1:string"</span> <span class="na">xmlns:p6=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
     user@client-company.com
    <span class="nt">&lt;/saml:AttributeValue&gt;</span>
   <span class="nt">&lt;/saml:Attribute&gt;</span>
  <span class="nt">&lt;/saml:AttributeStatement&gt;</span>
 <span class="nt">&lt;/saml:Assertion&gt;</span>
<span class="nt">&lt;/samlp:Response&gt;</span>
</code></pre></div>
<blockquote>
<p>Example form:</p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">action=</span><span class="s">"https://programme-name.com/saml/consume"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"SAMLResponse"</span> <span class="na">value=</span><span class="s">"AbCdefgh..."</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div>
<blockquote>
<p>Example conditions:</p>
</blockquote>
<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;saml:Conditions</span> <span class="na">NotBefore=</span><span class="s">"2020-01-01T00:00:00.000000Z"</span> <span class="na">NotOnOrAfter=</span><span class="s">"2020-01-01T02:00:00.000000Z"</span><span class="nt">&gt;</span>
 ...
<span class="nt">&lt;/saml:Conditions&gt;</span>
</code></pre></div>
<p>The value of the <code>SAMLResponse</code> parameter is a Base64-encoded <code>&lt;samlp:Response&gt;</code> element, which is transmitted to the service provider via the browser (see &quot;Example form&quot; for an example).</p>

<p>The assertion <strong>must</strong> have the following sub-elements (shown with namespaces from &quot;Example SAML assertion&quot;):</p>
<h4 id='saml-issuer-1'><code>saml:Issuer</code> [1]</h4>
<p>Name of the IdP in the form of a url e.g. <code>https://client-company.com</code>.</p>
<h4 id='ds-signature-2'><code>ds:Signature</code> [2]</h4>
<p>All SAML 2.0 Assertions are signed by default. The client company (identity provider) will be required
to include the X.509 Certificate public key in the assertion itself. MyRewards (service provider) will use this to verify the signature.</p>
<h4 id='saml-subject-3'><code>saml:Subject</code> [3]</h4>
<p>The subject <code>&lt;saml:NameID&gt;</code> is always the unique identifier of the user - by default this set as transient, we require this to be persistent - this is as understood by the IdP.</p>
<h4 id='saml-conditions-4'><code>saml:Conditions</code> [4]</h4>
<p>This is the timeframe within which the assertion is valid - our preference is to be set to allow for 2 minutes either side to account for clock drift between servers. MyRewards will verify the validity of an assertion with respect to these conditions after validating the signature.</p>

<p>Our servers are synchronised daily to Europe/London timezone - this will change with Daylight Saving Time. We expect the IdP has their server clocks similarly synchronised. The timestamp used will be in Coordinated Universal Time (UTC) and we strongly recommend adding a window of 1 hour plus 2 minutes to account for both clock drift and Daylight Saving Time.</p>

<p>For example, if the date/time was <code>Tuesday 9th October, 2018 15:09 (BST)</code> then we would expect to see the <code>&lt;saml:Conditions&gt;</code> element look like the snippet shown in &quot;Example conditions&quot;.</p>
<h4 id='saml-attributestatement'><code>saml:AttributeStatement</code></h4>
<p>The attribute statement is a list of name/value pairs conveying information about the user themselves. We only use one <code>&lt;saml:Attribute&gt;</code> with a <code>Name</code> specified by the programme configuration (<code>uid</code> by default) and expect the value to be one of:</p>

<ul>
<li>user&#39;s email address - as recorded on MyRewards Programme</li>
<li>username - as recorded on MyRewards Programme</li>
<li>unique identifier/primary key for the user as recorded in MyRewards Programme</li>
</ul>

<p>The value we expect is determined by the programme configuration.</p>
<h3 id='next-steps'>Next steps</h3>
<p>The following information is required to set up SAML SSO on the MyRewards system:</p>

<ul>
<li>URL of the identify provider</li>
<li>Fingerprint of X.509 certificate – this can be extracted from the public key</li>
<li>URL access redirect</li>
<li>Failed log in redirect (if not included in the assertion)</li>
<li>User identifier (id, email or username)</li>
</ul>

<p>In response, you will be provided with a metadata file - this can often be useful for automatically configuring some IdP systems such as Active Directory Federated Services.</p>
<h3 id='further-information'>Further information</h3>
<p>For further information on SAML 2.0 please go to the official SAML 2.0 websites:</p>

<ul>
<li><a href="http://www.oasis-open.org/home/index.php">http://www.oasis-open.org/home/index.php</a></li>
<li><a href="http://saml.xml.org">http://saml.xml.org</a></li>
</ul>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
